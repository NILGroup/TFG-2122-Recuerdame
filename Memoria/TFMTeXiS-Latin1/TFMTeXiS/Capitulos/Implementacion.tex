\chapter{Implementación de la aplicación}
\label{cap:implementacionDelTFG}
Para este TFG se ha desarrollado una aplicación web que será adaptable a dispositivo tablet. En este capitulo mostraremos la arquitectura que se ha decidido para la aplicación así como el diseño de la base de datos implementado. Además se mostrará cuales fueron las herramientas utilizadas y como fue implementada la aplicación

Todas nuestras decisiones fueron tomadas a partir de las requisitos y las especificaciones pedidas por los expertos que utilizaran la aplicación.

\section{Arquitectura}
Para la arquitectura de la aplicación se ha utilizado el patrón Modelo-Vista-Controlador (MVC). Este patrón se basa en separar la interfaz de usuario de la lógica de negocio y lo hace separando el código en 3 bloques:
\begin{itemize}
	\item \textbf{Modelo:} Es el encargado de gestionar la información almacenada en la base de datos y transformar los datos según las reglas de negocio.
	\item \textbf{Controlador:} Actúa de intermediario entre el Modelo y la Vista. La Vista realiza una petición al Controlador y éste se encarga de obtener los datos a través del Modelo y enviarlos a la Vista.
	\item \textbf{Vista:} Es la interfaz de usuario. Se encarga de realizar peticiones de datos al Controlador y mostrar la información necesaria con la que el usuario pueda interactuar.
\end{itemize}
Un ejemplo de este flujo entre los 3 bloques se puede ver en la Figura \ref{fig:str_mvc}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=5cm]{./Imagenes/Figuras/mvc_structure.png}
	\caption{Estructura de Modelo-Vista-Controlador}
	\label{fig:str_mvc}
\end{figure}
			
Esta decisión fue tomada debido a las grandes ventajas que este modelo impone en el código, algunas de estas son:
\begin{itemize}
	\item La separación clara de dónde tiene que ir cada tipo de lógica, facilita el mantenimiento y la escalabilidad de la aplicación.
	\item La facilidad para la realización de pruebas unitarias de los componentes y para el manejo de errores.
	\item La posibilidad de mostrar múltiples representaciones de los datos.
	\item La facilidad del control de versiones. 
	\item Facilita la división de trabajo.
\end{itemize}

Para aplicar este patrón de la manera más ordenada posible aplicamos esta división a cada modulo/acción que la aplicación realiza. Algunas de estas divisiones son:
\begin{itemize}
	\item Paciente: Controla la información del paciente a tratar y permite modificar, añadir y eliminar pacientes.
	\item Usuario: Controla la información del terapeuta y permite modificar, añadir y eliminar terapeutas.
	\item Sesiones: Controla las sesiones para el usuario, permite modificar, añadir y eliminar sesiones.
	\item Informes de sesión: Controla los informes de la sesiones realizadas y finalizadas. Permite modificar, añadir y eliminar los distintos informes.
	\item Informes de seguimiento: Controla los informes de seguimiento del paciente. Permite modificar, añadir y eliminar.
	\item Historia de vida: Permite mostrar la historia de vida del paciente con distintos filtros y en distintos formatos.
	\item Recuerdos: Controla los recuerdos del usuario. Permite modificar, añadir y eliminar los recuerdos.
	\item Personas Relacionadas: Controla los contactos del usuario. Permite modificar, añadir y eliminar las distintas personas.
	\item Calendario: Muestra el calendario por mes. Permite modificar, añadir y eliminar tareas en el calendario.
\end{itemize}

Como resultado, cada modulo tendrá: por una parte distintas vistas para sus distintas acciones y, por otra, un controlador y un modelo. Por ejemplo, en el caso del modulo ``Sesiones'', una de sus vistas es ``Modificar Datos de la Sesión'' que se encarga de mostrar la pantalla para modificar los distintos datos de una sesión. Además de eso, tiene un modelo que se encarga de pedir los datos de la sesión a la base de datos y un controlador que comunica la vista con el modelo.

La implementación de esta aplicación se ha llevado a cabo con la siguientes herramientas:
\begin{itemize}
	\item Para el front-end de la aplicación hemos utilizado HTML y CSS por la facilidad de uso y generación de código. También, hemos incorporado Bootstrap para los estilos de la aplicación ya que simplifica la generación de formulario. Además, Bootstrap genera código Responsive que es uno de los requisitos para poder utilizar la aplicación en tablets. Hemos usado una librería de Bootstrap llamada Fontawesome que es un conjunto de herramientas de fuentes e iconos basado en CSS.
	 Para la conexión con el Backend hemos utilizado JavaScript por sencillez y porque es un lenguaje que conocemos todos los integrantes del grupo. Dentro de JavaScript hemos utilizado un plugin para realizar el calendario llamado FullCalendar, que ofrece bastantes facilidades para ello.
	\item Para el back-end hemos utilizado PHP porque lo hemos utilizado en otras asignaturas y nos resulta muy familiar.
	\item Para almacenar los datos hemos utilizado el motor de base de datos MySQL porque es de código abierto.
	\item Como servidor local hemos utilizado Xampp porque es un servidor de plataforma libre y nos da muchas facilidades porque integra varias aplicaciones (MySQL, PHP). Además, se puede ejecutar en diversos sistemas operativos que nos ha facilitado colaborar en equipo.
	\item Como herramienta de control de versiones hemos utilizao GitHub ya que es donde alojamos todo el material del TFG.
	\item Para desarrollar la aplicación utilizamos  Visual Studio Code como editor de código puesto que consideramos que es el más completo y con el que más familiarizados estamos.
	\item Para el desarrollo de la lógica de la aplicación hemos aplicado programación orientada a objetos para tratar los diferentes elementos con los que trabaja el backend de la aplicación.
\end{itemize}

\section{Base de datos}
Tras realizar un estudio cerciorado de las necesidades del proyecto. Observamos que para el modelo de datos de la aplicación, teníamos que decidir entre dos opciones: coger una base de datos relacional o una base de datos no relacional.

Las bases de datos no relacionales están pensadas para ser utilizadas cuando: la estructura de la base datos no tiene esquemas específicos, se guardan grandes cantidades de información o se realizan grandes movimientos de datos en momentos puntuales. Lo cual no es el caso de nuestra aplicación. Ademas su compatibilidad con servidores y distintos sistemas operativos es mas complicada. Por lo mencionado anteriormente, decidimos que la mejor forma de guardar la base de datos de nuestra aplicación sería una base de datos relacional, y entre ellas escogimos MySQL. Por varias razones:
\begin{itemize}
	\item Su portabilidad: puede ser usado en distintos dispositivos como ordenadores, tablets y moviles.
	\item Su gratuidad, al ser código abierto no requiere de ningún coste.
	\item Su eficiencia: necesita pocos requerimientos y ocupa poca memoria.
	\item Su experiencia: al ser uno de los mas usados, existe gran cantidad de información.
	\item Su seguridad: al tratar con datos muy personales de alto riesgo, es muy importante estar seguros de donde se están alojando esos datos. MySQL es altamente seguro, gracias a varias funciones avanzadas de seguridad.
\end{itemize}	

La estructura de la base de datos (Figura \ref{fig:str_bd}) fue definida, en parte, por toda la información aportada por los terapeutas durante las entrevistas y durante la evaluación del diseño competitivo.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=17cm]{./Imagenes/Figuras/estructura_bd.jpeg}
	\caption{Estructura de la base de datos}
	\label{fig:str_bd}
\end{figure}

\subsection{Tabla usuario}
Contiene toda la información de los usuarios (terapeutas y cuidadores) que pueden iniciar sesión en la aplicación. Los atributos se pueden ver en la Figura \ref{fig:bd_usuario}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/usuario.png}
	\caption{Tabla de base de datos usuario.}
	\label{fig:bd_usuario}
\end{figure}

\subsection{Tabla paciente}
Tabla con la información de los pacientes a tratar que podrán ser asignados a los terapeutas o a un cuidador. Los atributos se pueden ver en la Figura \ref{fig:bd_paciente}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/paciente.png}
	\caption{Tabla de base de datos paciente.}
	\label{fig:bd_paciente}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_CUIDADOR_PACIENTE|: referencia a la tabla usuario.
\end{itemize}

\subsection{Tabla sesion}
Tabla con la información de las sesiones que el terapeuta realiza con los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_sesion}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/sesion.png}
	\caption{Tabla de base de datos sesion.}
	\label{fig:bd_sesion}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_SESION_ETAPA|: referencia a la tabla etapa.
	\item \verb|FK_SESION_PACIENTE|: referencia a la tabla paciente.
	\item \verb|FK_SESION_USUARIO|: referencia a la tabla usuario.
\end{itemize}

\subsection{Tabla recuerdo}
Tabla con la información de los recuerdos de todos los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_recuerdo}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/recuerdo.png}
	\caption{Tabla de base de datos recuerdo.}
	\label{fig:bd_recuerdo}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_RECUERDO_CATEGORIA|: referencia a la tabla categoria.
	\item \verb|FK_RECUERDO_EMOCION|: referencia a la tabla emocion.
	\item \verb|FK_RECUERDO_ESTADO|: referencia a la tabla estado.
	\item \verb|FK_RECUERDO_ETAPA|: referencia a la tabla etapa.
	\item \verb|FK_RECUERDO_ETIQUETA|: referencia a la tabla etiqueta.
	\item \verb|FK_RECUERDO_PACIENTE|: referencia a la tabla paciente.
\end{itemize}

\subsection{Tabla multimedia}
Tabla con la información de los acrhivos multimedia de todos los pacientes. Estos archivos multimedia se utilizan tanto en las sesiones como en los recuerdos. Los atributos se pueden ver en la Figura \ref{fig:bd_multimedia}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/multimedia.png}
	\caption{Tabla de base de datos multimedia.}
	\label{fig:bd_multimedia}
\end{figure}

\subsection{Tabla evaluacion}
Tabla con la información de las evaluaciones que hacen los terapeutas a los pacientes para ver su progreso. Los atributos se pueden ver en la Figura \ref{fig:bd_evaluacion}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/evaluacion.png}
	\caption{Tabla de base de datos evaluacion.}
	\label{fig:bd_evaluacion}
\end{figure}

\subsection{Tabla \texttt{persona\char`_relacionada}}
Tabla con la información de las personas que están relacionadas con los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_persona_relacionada}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/persona_relacionada.png}
	\caption{Tabla de base de datos \texttt{persona\char`_relacionada}.}
	\label{fig:bd_persona_relacionada}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_PERSONA_RELACIONADA_TIPO_RELACION|: referencia a la tabla \texttt{tipo\char`_relacion}.
	\item \verb|FK_PERSONA_RELACIONADA_PACIENTE|: referencia a la tabla paciente.
\end{itemize}

\subsection{Tabla actividad}
Tabla con la información de las actividades que el terapeuta ha asignado al paciente para que las realice con su cuidador. Los atributos se pueden ver en la Figura \ref{fig:bd_actividad}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/actividad.png}
	\caption{Tabla de base de datos actividad.}
	\label{fig:bd_actividad}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_ACTIVIDAD_PACIENTE|: referencia a la tabla paciente.
\end{itemize}

\subsection{Tabla \texttt{tipo\char`_relacion}}
Tabla que contiene los tipos de relación que pueden tener las personas que están relacionadas con los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_tipo_relacion}. Esta tabla se carga inicialmente con los datos que se pueden ver en la Figura \ref{fig:bd_tipo_relacion_datos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/tipo_relacion.png}
	\caption{Tabla de base de datos \texttt{tipo\char`_relacion}.}
	\label{fig:bd_tipo_relacion}
\end{figure}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=3cm]{./Imagenes/Figuras/base_de_datos/tipo_relacion_datos.png}
	\caption{Datos de la tabla de base de datos \texttt{tipo\char`_relacion}.}
	\label{fig:bd_tipo_relacion_datos}
\end{figure}

\subsection{Tabla etiqueta}
Tabla que contiene las etiquetas que pueden tener los recuerdos de los pacientes y que sirven para indicar si un recuerdo es positivo, neutro o negativo. Los atributos se pueden ver en la Figura \ref{fig:bd_etiqueta}. Esta tabla se carga inicialmente con los datos que se pueden ver en la Figura \ref{fig:bd_etiqueta_datos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/etiqueta.png}
	\caption{Tabla de base de datos etiqueta.}
	\label{fig:bd_etiqueta}
\end{figure}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=3cm]{./Imagenes/Figuras/base_de_datos/etiqueta_datos.png}
	\caption{Datos de la tabla de base de datos etiqueta.}
	\label{fig:bd_etiqueta_datos}
\end{figure}

\subsection{Tabla etapa}
Tabla que contiene las etapas de vida que pueden tener las sesiones y los recuerdos de los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_etapa}. Esta tabla se carga inicialmente con los datos que se pueden ver en la Figura \ref{fig:bd_etapa_datos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/etapa.png}
	\caption{Tabla de base de datos etapa.}
	\label{fig:bd_etapa}
\end{figure}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=3cm]{./Imagenes/Figuras/base_de_datos/etapa_datos.png}
	\caption{Datos de la tabla de base de datos etapa.}
	\label{fig:bd_etapa_datos}
\end{figure}

\subsection{Tabla estado}
Tabla que contiene las tipo de estados que pueden tener los recuerdos de los pacientes y que sirven para indicar si un recuerdo está conservado, en riesgo de perder o perdido. Los atributos se pueden ver en la Figura \ref{fig:bd_estado}. Esta tabla se carga inicialmente con los datos que se pueden ver en la Figura \ref{fig:bd_estado_datos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/estado.png}
	\caption{Tabla de base de datos estado.}
	\label{fig:bd_estado}
\end{figure}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=3cm]{./Imagenes/Figuras/base_de_datos/estado_datos.png}
	\caption{Datos de la tabla de base de datos estado.}
	\label{fig:bd_estado_datos}
\end{figure}

\subsection{Tabla emocion}
Tabla que contiene las tipo de emoción que pueden tener los recuerdos de los pacientes y que sirven para indicar la emoción que le surge al paciente con el recuerdo. Los atributos se pueden ver en la Figura \ref{fig:bd_emocion}. Esta tabla se carga inicialmente con los datos que se pueden ver en la Figura \ref{fig:bd_emocion_datos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/emocion.png}
	\caption{Tabla de base de datos emocion.}
	\label{fig:bd_emocion}
\end{figure}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=3cm]{./Imagenes/Figuras/base_de_datos/emocion_datos.png}
	\caption{Datos de la tabla de base de datos emocion.}
	\label{fig:bd_emocion_datos}
\end{figure}

\subsection{Tabla categoria}
Tabla que contiene las tipo de categorías que pueden tener los recuerdos de los pacientes y que sirven para indicar con qué está relacionado el recuerdo (familia, hobbies, amistad, trabajo, política, estudios u otros). Los atributos se pueden ver en la Figura \ref{fig:bd_categoria}. Esta tabla se carga inicialmente con los datos que se pueden ver en la Figura \ref{fig:bd_categoria_datos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/categoria.png}
	\caption{Tabla de base de datos categoria.}
	\label{fig:bd_categoria}
\end{figure}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=3cm]{./Imagenes/Figuras/base_de_datos/categoria_datos.png}
	\caption{Datos de la tabla de base de datos categoria.}
	\label{fig:bd_categoria_datos}
\end{figure}

\subsection{Tabla terapeuta}
Tabla con la relación de terapeutas y pacientes que sirve para asignar los pacientes a varios terapeutas. Los atributos se pueden ver en la Figura \ref{fig:bd_terapeuta}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/terapeuta.png}
	\caption{Tabla de base de datos terapeuta.}
	\label{fig:bd_terapeuta}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_TERAPEUTA_USUARIO|: referencia a la tabla usuario.
	\item \verb|FK_TERAPEUTA_PACIENTE|: referencia a la tabla paciente.
\end{itemize}

\subsection{Tabla \texttt{sesion\char`_recuerdo}}
Tabla con la relación de sesiones y recuerdos que sirve para asignar los recuerdos de los pacientes a las sesiones. Los atributos se pueden ver en la Figura \ref{fig:bd_sesion_recuerdo}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/sesion_recuerdo.png}
	\caption{Tabla de base de datos \texttt{sesion\char`_recuerdo}.}
	\label{fig:bd_sesion_recuerdo}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_SESION_RECUERDO_RECUERDO|: referencia a la tabla recuerdo.
	\item \verb|FK_SESION_RECUERDO_SESION|: referencia a la tabla sesion.
\end{itemize}

\subsection{Tabla \texttt{sesion\char`_multimedia}}
Tabla con la relación de sesiones y archivos multimedia que sirve para asignar los archivos multimedia a las sesiones de los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_sesion_multimedia}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/sesion_multimedia.png}
	\caption{Tabla de base de datos \texttt{sesion\char`_multimedia}.}
	\label{fig:bd_sesion_multimedia}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_SESION_MULTIMEDIA_MULTIMEDIA|: referencia a la tabla multimedia.
	\item \verb|FK_SESION_MULTIMEDIA_SESION|: referencia a la tabla sesion.
\end{itemize}

\subsection{Tabla \texttt{recuerdo\char`_persona\char`_ralacionada}}
Tabla con la relación de recuerdos y personas relacionadas de los pacientes que sirve para asignar las personas relacionadas a los recuerdos de los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_recuerdo_persona_relacionada}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/recuerdo_persona_relacionada.png}
	\caption{Tabla de base de datos \texttt{recuerdo\char`_persona\char`_relacionada}.}
	\label{fig:bd_recuerdo_persona_relacionada}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_RECUERDO_PERSONA_RELACIONADA_PERSONA_RELACIONADA|: referencia a la tabla \texttt{persona\char`_relacionada}.
	\item \verb|FK_RECUERDO_PERSONA_RELACIONADA_RECUERDO|: referencia a la tabla recuerdo.
\end{itemize}

\subsection{Tabla \texttt{recuerdo\char`_multimedia}}
Tabla con la relación de recuerdos y archivos multimedia que sirve para asignar los archivos multimedia a los recuerdos de los pacientes. Los atributos se pueden ver en la Figura \ref{fig:bd_recuerdo_multimedia}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=14cm]{./Imagenes/Figuras/base_de_datos/recuerdo_multimedia.png}
	\caption{Tabla de base de datos \texttt{recuerdo\char`_multimedia}.}
	\label{fig:bd_recuerdo_multimedia}
\end{figure}

Esta tabla tiene las siguientes foreign keys:
\begin{itemize}
	\item \verb|FK_RECUERDO_MULTIMEDIA_MULTIMEDIA|: referencia a la tabla multimedia.
	\item \verb|FK_RECUERDO_MULTIMEDIA_RECUERDO|: referencia a la tabla recuerdo.
\end{itemize}


\section{Funcionalidades}
A continuación, se describirán todas las funcionalidades de la aplicación.

\subsection{Login}
Pantalla que permite al cuidador y al terapeuta iniciar sesión en la aplicación. Para ello, tienen que introducir su correo y contraseña como se muestra en la Figura \ref{fig:login}. En caso de que uno de los dos sea incorrecto se mostrará el error "Usuario o contraseña incorrectos.", en caso contrario se accederá a la pantalla inicial de la aplicación tal y como se muestra en el diagrama de secuencia que se muestra en la Figura \ref{fig:d_login} .
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=8cm]{./Imagenes/Figuras/implementacion/login.png}
  	\caption{Pagina de login.}
	\label{fig:login}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/login.png}
  	\caption{Diagrama de secuencia del proceso login.}
	\label{fig:d_login}
\end{figure}


\subsection{Listado de registros}
En la aplicación se pueden encontrar los siguientes listados: pacientes, sesiones, informes de sesión, informes de evaluación, recuerdos y personas relacionadas.
En este caso vamos a explicar el listado de pacientes. El listado muestra todos los registros tal y como se muestra en la Figura \ref{fig:listado} y, en el caso de que un listado tenga una columna de fecha, éste se muestra ordenado por dicha fecha. En todas las listas se puede añadir un nuevo registro, ver, modificar y eliminar. Además, se pueden ordenar ascendente o descendentemente por cada columna y tienen un buscador para buscar en toda la lista. El usuario hace una petición al Controlador (ControladorPacientes) mediante la vista listadoPacientes, seleccionando la opción de pacientes (icono de usuarios). El Controlador, mediante la función listadoPacientes(idTerapeuta), hace una petición al modelo Paciente que recupera todos los registros filtrando por el terapeuta y, devuelve el listado para que la vista lo muestre. A continuación se muestra la pantalla de uno de ellos (ver Figura \ref{fig:listado}) el diagrama de secuencia (ver Figura \ref{fig:lista})de un de ellos que sirve como ejemplo de lo que hacen todos los listados de la aplicación.
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/listado.png}
  	\caption{Pantalla del listado de sesiones.}
	\label{fig:listado}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/lista.png}
  	\caption{Diagrama de secuencia del listado de pacientes.}
	\label{fig:lista}
\end{figure}

\subsection{Crear un nuevo registro}
Hay varios listados que permiten crear un nuevo registro. En este caso se va a explicar la creación de un nuevo paciente. En el listado de pacientes se puede encontrar el botón de añadir un nuevo registro con el botón ``Nuevo paciente'' en el caso del listado pacientes y el botón con el icono ``+'' en el resto de listados. El usuario hace una petición al front mediante el botón y la vista llama al gestor de las vistas del front para hacer una redirección al formulario de nuevo paciente tal y como se puede ver en la Figura \ref{fig:anadir}. Para poder crear un nuevo registro es necesario introducir todos los datos obligatorios que se muestran en la pantalla mediante un asterisco (``*''). El usuario hace una petición mediante el botón Guardar y la vista manda al gestor los datos del nuevo registro para validarlos. Una vez el gestor ha validado los datos, hace una petición al Controlador (ControladorPacientes) que mediante la función nuevoPaciente (paciente) hace una petición al modelo Paciente que se encarga de añadir el nuevo registro a la base de datos.
En la aplicación se pueden encontrar los siguientes formularios para crear nuevos registros: nuevo paciente, nueva sesión, nueva informe de seguimiento, nuevo informe de sesión, nuevo recuerdo y una persona relacionada. A continuación se muestra la pantalla de uno de ellos (ver Figura \ref{fig:anadir}) el diagrama de secuencia (ver figura \ref{fig:crearPac})de un de ellos que sirve como ejemplo de lo que hacen todos los listado de la aplicación.
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/anadir.png}
  	\caption{Crear un nuevo paciente.}
	\label{fig:anadir}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/modcrearpaciente.png}
  	\caption{Diagrama de secuencia nuevo paciente.}
	\label{fig:crearPac}
\end{figure}

\subsection{Modificar un registro}
En la aplicación se pueden encontrar los siguientes formularios para modificar registros: modificar paciente, modificar sesión, modificar informe de seguimiento, modificar informe de sesión, modificar recuerdo y modificar una persona relacionada.
En este caso vamos a explicar como se modifica un paciente. Mediante el botón de modificar (icono de un lápiz) que se encuentra en el listado de pacientes tal y como podemos observar en la Figura \ref{fig:listado}, el usuario hace una petición para que posteriormente la aplicación nos llevaría a la página de edición en la que una vez hayamos seleccionado el botón guardar, mandará una orden a la base de datos para que ésta sea modificada. Posteriormente una vez volvamos a acceder a aquella lista que modificada, podremos observar que se ha hecho el cambio. A continuación se muestra la pantalla de uno de ellos (ver Figura \ref{fig:modificar}) el diagrama de secuencia(ver figura \ref{fig:modPaciente} de un de ellos que sirve como ejemplo de lo que hacen todos los formularios de modificar un registro. 
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/modificar.png}
  	\caption{Botón de modificación.}
	\label{fig:modificar}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/modcrearpaciente.png}
  	\caption{Diagrama de secuencia modificar paciente.}
	\label{fig:modPaciente}
\end{figure}
\subsection{Eliminar un registro}
El botón de eliminar lo podemos encontrar en todas las listas con el icono de una basura como podemos observar en la Figura \ref{fig:listado}. Para poder hacer uso de él simplemente se haría click en él y posteriormente la aplicación eliminaría la el paciente (en el caso de que estuviésemos en la lista de los pacientes) haciendo llegar una petición a la base de datos con la orden de eliminar por la id del usuario.
En la aplicación se pueden eliminar los siguientes registros: paciente, sesión, informe de seguimiento, informe de sesión, recuerdo y persona relacionada.
(Ver Figura \ref{fig:eliminarPac} el diagrama de secuencia de un de ellos que sirve como ejemplo de lo que hacen todos los formularios de eliminar un registro).

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/delete.png}
  	\caption{Diagrama de secuencia eliminar paciente.}
	\label{fig:eliminarPac}
\end{figure}
\subsection{Generar Libro de vida}
El usuario indica los filtros que desee (fecha, etiqueta y etapa de vida) para generar la Historia de Vida y hace una petición mediante el botón ``Generar Historia de Vida'' y el front envía una petición al gestor de las vistas del front que a su vez llama al Controlador (ControladorHistoriaVida) que mediante la función generarLibroHistoriaVida (filtros) hace una petición al modelo Recuerdo para que recupere la información de la base de datos y devuelva un listado de recuerdos.
A continuación se muestra el libro de Historia de Vida (ver Figura \ref{fig:libroDeVida.png}) el diagrama de secuencia (ver figura \ref{fig:libroVidaPac}).
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/libroDeVida.png}
  	\caption{Generar Libro de Vida.}
	\label{fig:libroDeVida.png}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/generarLibro.png}
  	\caption{Diagrama de secuencia generar libro de vida del paciente.}
	\label{fig:libroVidaPac}
\end{figure}
\subsection{Generar PDF}
Se pueden generar 3 pdf en la aplicación que son: Historia de Vida, Informe de sesión e Informe de Seguimiento. En este caso vamos a explicar como se genera el PDF de Historia de Vida. El usuario genera una petición mediante el botón ``Generar PDF'' y el front envía una petición al gestor de las vistas del front que a su vez llama al Controlador (ControladorHistoriaVida) que mediante la función generarPDFHistoriaVida (filtros) hace una petición al modelo Recuerdo para que recupere la información de la base de datos y devuelva un listado de recuerdos.
A continuación se muestra el PDF de Historia de Vida (ver Figura \ref{fig:pdf.png}) el diagrama de secuencia (ver figura \ref{fig:pdfPac}). 
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/pdf.png}
  	\caption{Generar PDF.}
	\label{fig:pdf.png}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/generarPDF.png}
  	\caption{Diagrama de secuencia generar historia de vida en PDF .}
	\label{fig:pdfPac}
\end{figure}
\subsection{Añadir un registro ya existente}
En el caso de los archivos multimedia en recuerdos y sesiones se pueden añadir archivos ya existentes en otros recuerdos o sesiones. En el caso de las sesiones se pueden añadir recuerdos ya existentes del paciente. Y en el caso de los recuerdos se pueden añadir personas relacionadas ya existentes del paciente.
En este caso vamos a explicar como se añade una persona relacionada ya existente en otros recuerdos del paciente.
El usuario hace una petición mediante el botón ``Añadir existente'' y el front envía una petición al Controlador (ControladorPersonasRelacionadas) que mediante la función personasRelacionadasRecuerdo(idRecuerdo) envía una petición al modelo PersonaRelacionada para que devuelva el listado de las personas relacionadas de un paciente y la vista muestre el listado indicando cuáles ya existen en el recuerdo y cuáles no. El usuario selecciona/deselecciona las personas relacionadas que quiere añadir o quitar del recuerdo y envía una petición mediante el botón ``Añadir'' para que el front llame al Controlador (a través del gestor del front). El Controlador (ControladorPersonaRelacionada) envía una petición al modelo para que elimine todas las personas relacionadas de un recuerdo y asigne, mediante la función guardarPersonasRelacionadas(idRecuerdo, lista), las que ha seleccionado el usuario mediante la vista.
A continuación se muestra la lista de personas relacionadas asignadas a un recuerdo (ver Figura \ref{fig:anadirExistente.png}) y el diagrama de secuencia (ver figura \ref{fig:andExistPac}). 
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/anadirExistente.png}
  	\caption{Añadir personas relacionadas a un recuerdo.}
	\label{fig:anadirExistente.png}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/andExist.png}
  	\caption{Diagrama de secuencia añadir personas relacionadas a un recuerdo.}
	\label{fig:andExistPac}
\end{figure}
\subsection{Crear un informe de sesión}
El usuario hace una petición al front mediante el botón de informe (icono de un documento) en el listado de sesiones y la vista llama al gestor de las vistas del front para hacer una redirección al formulario de nuevo informe de seguimiento tal y como se puede ver en la Figura \ref{fig:anadirInformeSesion}. El usuario hace una petición mediante el botón Guardar y la vista manda al gestor los datos del nuevo registro para validarlos. Una vez el gestor ha validado los datos, hace una petición al Controlador (InformeSesionController) que mediante la función guardarInformeSesion (informe) hace una petición al modelo InformeSesion que se encarga de añadir el nuevo registro a la base de datos.
A continuación se muestra la pantalla de creación del informe de sesión (ver Figura \ref{fig:anadirInformeSesion}) y el diagrama de secuencia de un de ellos (ver Figura \ref{fig:crearInformeSesion})que sirve como ejemplo de lo que hacen todos los listado de la aplicación.
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/anadirInformeSesion.png}
  	\caption{Crear un nuevo informe de sesión.}
	\label{fig:anadirInformeSesion}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/Crear_informe_sesion.png}
  	\caption{Diagrama de secuencia crear un nuevo informe de sesión.}
	\label{fig:crearInformeSesion}
\end{figure}
\subsection{Calendario de actividades}
El front hace una petición al modelo actividad que recupera el listado de actividades del paciente y el front las añade en el calendario. En la figura \ref{fig:calendar} diagrama de secuencia del calendario 
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/calendario.png}
  	\caption{Calendario de actividades.}
	\label{fig:calendario}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/calendario.png}
  	\caption{Diagrama de secuencia calendario.}
	\label{fig:calendar}
\end{figure}



\subsection{Registro de un terapeuta}
El usuario introduce todos los datos del formulario que se muestra en la Figura \ref{fig:registroTerapeuta} y mediante el botón Guardar hace una petición que procesa el front y hace una llamada al Controlador (UsuarioController) para guardar el nuevo usuario mediante la función guardarUsuario (usuario) que hace una petición al modelo Usuario que guarda los datos en la base de datos.
A continuación se muestra la pantalla de registro de un terapeuta (ver Figura \ref{fig:registroTerapeuta}) y el diagrama de secuencia en la figura \ref{fig:regTerapeuta}.

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/registroTerapeuta.png}
  	\caption{Registro de un nuevo terapeuta.}
	\label{fig:registroTerapeuta}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/terapeuta.png}
  	\caption{Diagrama de secuencia registro terapeuta.}
	\label{fig:regTerapeuta}
\end{figure}

\subsection{Registro de un cuidador}
El usuario introduce todos los datos del formulario que se muestra en la Figura \ref{fig:registroCuidador} y mediante el botón Guardar hace una petición que procesa el front y hace una llamada al Controlador (UsuarioController) para guardar el nuevo usuario mediante la función guardarUsuario (usuario) que hace una petición al modelo Usuario que guarda los datos en la base de datos. Además, asigna el cuidador al paciente seleccionado en el formulario mediante la función asignarCuidador (idCuidador, idPaciente) del UsuarioController y éste hace una petición al modelo Usuario que mediante la función asignarCuidador (idCuidador, idPaciente) asigna el paciente al nuevo cuidador.
A continuación se muestra la pantalla de registro de un terapeuta (ver Figura \ref{fig:registroTerapeuta}) y el diagrama de secuencia en la figura \ref{fig:regCuidador}.
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/registroCuidador.png}
  	\caption{Registro de un nuevo cuidador.}
	\label{fig:registroCuidador}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/cuidador.png}
  	\caption{Diagrama de secuencia registro cuidador.}
	\label{fig:regCuidador}
\end{figure}
\subsection{Cambio de contraseña de un usuario}
La aplicación permite recuperar la contraseña por si un usuario no la recuerda. El usuario debe indicar su correo electrónico y el UsuarioController comprueba si el usuario existe mediante la función comprobarUsuario (usuario). En caso de que exista se le pide la nueva contraseña y se modifica mediante la función modificarContrasenia (contraseña, correo) que hace una llamada al modelo Usuario y encripta y modifica su contraseña mediante la función modificarUsuario(contraseña, correo).  Ver el diagrama de secuencia en la figura \ref{fig:camb}.
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/cambioContrasena.png}
  	\caption{Cambio de contraseña de un usuario.}
	\label{fig:cambioContrasena}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/olvido.png}
  	\caption{Diagrama de secuencia cambio contraseña.}
	\label{fig:camb}
\end{figure}
\subsection{Logout}
Se encuentra en la parte superior derecha de la pantalla y permite al usuario salir de la aplicación. Este botón lo podemos ubicar fácilmente en la siguiente Figura \ref{fig:logout}. Y le correspondería el siguiente diagrama de secuencia ( Ver figura \ref{fig:logout}).
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=15cm]{./Imagenes/Figuras/implementacion/logout.png}
  	\caption{Botón de logout.}
	\label{fig:login}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/diagramas_secuencia/logout.png}
  	\caption{Diagrama de secuencia del proceso logout.}
	\label{fig:logout}
\end{figure}