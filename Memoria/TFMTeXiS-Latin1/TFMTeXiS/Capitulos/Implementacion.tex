\chapter{Implementación}
\label{cap:implementacionDelTFG}

	Una vez establecida la arquitectura de la base de datos y de la aplicación, se comienza a realizar la implementación de la aplicación siguiendo los patrones definidos en el capítulo anterior.

\section{Herramientas utilizadas para la implementación}
La implementación de esta aplicación se ha llevado a cabo con la siguientes herramientas:
\begin{itemize}
	\item Para el front-end de la aplicación hemos utilizado HTML y CSS por la facilidad de uso y generación de código. También, hemos incorporado Bootstrap para los estilos de la aplicación ya que simplifica la generación de formulario. Además, Bootstrap genera código Responsive que es uno de los requisitos para poder utilizar la aplicación en tablets. Hemos usado una librería de Bootstrap llamada Fontawesome que es un conjunto de herramientas de fuentes e iconos basado en CSS.
	 Para la conexión con el Backend hemos utilizado JavaScript por sencillez y porque es un lenguaje que conocemos todos los integrantes del grupo. Dentro de JavaScript hemos utilizado un plugin para realizar el calendario llamado FullCalendar, que ofrece bastantes facilidades para ello.
	\item Para el back-end hemos utilizado PHP porque lo hemos utilizado en otras asignaturas y nos resulta muy familiar.
	\item Para almacenar los datos hemos utilizado el motor de base de datos MySQL porque es de código abierto.
	\item Como servidor local hemos utilizado Xampp porque es un servidor de plataforma libre y nos da muchas facilidades porque integra varias aplicaciones (MySQL, PHP). Además, se puede ejecutar en diversos sistemas operativos que nos ha facilitado colaborar en equipo.
	\item Como herramienta de control de versiones hemos utilizao GitHub ya que es donde alojamos todo el material del TFG.
	\item Para desarrollar la aplicación utilizamos  Visual Studio Code como editor de código puesto que consideramos que es el más completo y con el que más familiarizados estamos.
	\item Para el desarrollo de la lógica de la aplicación hemos aplicado programación orientada a objetos para tratar los diferentes elementos con los que trabaja el backend de la aplicación.
\end{itemize}


\section{Desarrollo interfaz gráfica y objetos}

A continuación, se describirá la interfaz gráfica de la aplicación, así como los objetos relacionados con cada parte de esta interfaz gráfica.

\subsection{Login}

En primer lugar, al entrar en la aplicación aparece la página de login.php, donde el terapeuta o cuidador entrará en la aplicación. Aparece un cuadro para introducir las credenciales e iniciar sesión y luego una opción para que se registre un terapeuta (Figura \ref{fig:login}). 
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=8cm]{./Imagenes/Figuras/implementacion/login.png}
  	\caption{Pagina de login.}
	\label{fig:login}
\end{figure}

\subsection{Sesión del Terapeuta}

Una vez logueado en la aplicación como terapeuta nos aparecerá una página (Figura \ref{fig:listPac}) donde se muestra distintos componentes:
\begin{itemize}
	\item La cabecera y el pie de pagina: La cabecera contiene el logo de la aplicación en la parte izquierda, y en la otra esquina, los iconos para acceder a la lista de pacientes, acceder a la mensajería y cerrar la sesión. El pie de página solamente muestra el sello de copyright. Estas dos secciones se mantendrán mientras la sesión esté iniciada.
	\item: Listado de pacientes: donde se mostraran todos los pacientes que el terapeuta tenga registrado o asignado.
\end{itemize}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/listPacientes.png}
  	\caption{Listado de pacientes.}
	\label{fig:listPac}
\end{figure}


Cuando seleccionemos un paciente de la lista, se nos redirigirá a una página donde nos aparecerán la información general del paciente seleccionado. Su nombre, apellidos, genero, lugar y fecha de nacimiento, nacionalidad, dirección y tipo de residencia (Figura \ref{fig:pac}). Además, mientras un paciente esté seleccionado, aparecerá un componente nuevo: La barra de navegación. Por un lado nos permitirá navegar por todas las secciones (sesiones, evaluaciones, historias de vida y calendario). Por otra, nos mostrará un resumen de la información del paciente.  

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/paciente.png}
  	\caption{Información del paciente.}
	\label{fig:pac}
\end{figure}
s
A continuación se explican cada una de las secciones de esta barra de navegación:
 
\begin{itemize}
 	
 	\item Sesión: Este componente se encarga de la lógica del tratamiento de sesiones. A través de él accedemos al listado de las sesiones de un paciente (Figura \ref{fig:listses}). De cada sesión del listado aparece: su fecha, la descripción, si esta finalizada o no y las opciones de editar, ver y eliminar. Si seleccionamos en la fecha o en en el botón de ver, nos aparecerá un formulario no editable con la información de la sesión como son la fecha, etapa, terapeuta que realiza la sesión, objetivo, descripción, barreras, facilitadores, con el material a utilizar, como pueden ser recuerdos o archivos multimedia (como podemos ver en las Figuras \ref{fig:ses} y \ref{fig:ses2}. Si seleccionamos el botón de editar, nos aparecerá el mismo formulario con los datos de la sesión pero en este caso si que se podrán editar y guardar los cambios realizados. Si seleccionamos eliminar, se eliminará la sesión.
 				
 \begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/sesiones.png}
  	\caption{Listado sesiones.}
  	
	\label{fig:listses}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/ses.png}
  	\caption{Información de la  sesión.}
  	\label{fig:ses}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/ses2.png}
  	\caption{Información de la sesión.}
  	\label{fig:ses2}
\end{figure}

\item Informe de sesión: Componente con el que se manejan los informes de las sesiones. Estos informes son realizados por el terapeuta una vez terminada la sesión con el paciente. Cuando accedemos a la página, podremos visualizar un listado con todos los informes de sesión (Figura: \ref{fig:InfSes}). De cada informe de la lista se muestra el número del informe, la fecha y los botones de visualización, edición y borrado. Si en un informe de la lista seleccionamos en el numero del informe o en en el botón de ver, nos aparecerá un formulario no editable con la respuesta del paciente a la sesión y las observaciones realizadas por el terauta (Figura: \ref{fig:datSes}). Además aparecerá un botón que permitirá generar un PDF con la información detallada anteriormente(Figura: \ref{fig:pdfSes}). Si en la lista de informes, se pulsa el botón de editar, los campos del formulario no estarán bloqueados y serán editables.
 		\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/infSes.png}
  	\caption{Listado informes de sesion.}
	\label{fig:InfSes}
\end{figure}
 		\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/datInfSes.png}
  	\caption{Datos informe de sesión.}
  	
	\label{fig:datSes}
\end{figure}
	\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/pdfInfSes.png}
  	\caption{PDF informe de sesión.}
  	
	\label{fig:pdfSes}
\end{figure}
 		
 		\item Informe de seguimiento: Este componente permite la creación de los informes de seguimiento de un paciente. Los cuales se realizan cada 3 meses para diagnosticar el estado del paciente. En la página aparecerá un listado con todos los informes de seguimiento realizados con la fecha de realización, el diagnostico, un enlace para ver los datos del informe y las opciones de visualizar, editar y eliminar el informe (Figura \ref{fig:infSegui}).
  \begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/infSegui.png}
  	\caption{Listado informes de seguimiento.}
	\label{fig:infSegui}
\end{figure}

 		Esta lista sigue la misma mecánica que las listas anteriores, cambiando la información que se muestra en el formulario. Este, muestra las diferentes escalas( GDS, minimental/MEC de Lobo y CDR) con su respectivo valor y la fecha en la que se documentó el dato, con la posibilidad de introducir otro dato, también el diagnóstico final y un area de texo con las observaciones(Figura \ref{fig:datInfSegui}). Por último, esta la posibilidad de generas un PDF con la información anteriormente detallada(Figura \ref{fig:pdfInfSegui}).
 		
 		\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/datInfSegui.png}
  	\caption{Datos informe de seguimiento.}
	\label{fig:datInfSegui}
\end{figure}
	\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/pdfInfSegui.png}
  	\caption{PDF con datos informe de seguimiento.}
	\label{fig:pdfInfSegui}
\end{figure}

		\item Historia de vida: En cuanto a este objeto en la aplicación podemos verlo en el cuadro de navegación anteriormente comentado y dentro de este estarán las opciones de generar historia de vida, recuerdos y persona relacionada. En la opción de generar historia de vida podremos seleccionar un rango de tiempo, una etapa de la vida, una categoría de los recuerdos y una etiqueta, según sea el recuerdo positivo, negativo o neutro,como vemos en la figura \ref{fig:GHV}, y una vez todo lo anterior seleccionado se podrá generar un libro de vida (figura \ref{fig:lv1} y figura \ref{fig:lv2}) con todos esos recuerdos que podremos ver en la página de la aplicación y además podremos generar un pdf de este libro de vida (figura \ref{fig:pdfLV}).
	\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/genHV.png}
  	\caption{Generar historia de vida.}
  	\label{fig:GHV}
\end{figure}
		
	\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/librodevida1.png}
  	\caption{Pagina libro de vida.}
  	\label{fig:lv1}
\end{figure}

	\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/librodevida2.png}
  	\caption{Pagina libro de vida.}
  	\label{fig:lv2}
\end{figure}

\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/pdfLV.png}
  	\caption{PDF libro de vida.}
  	\label{fig:pdfLV}
\end{figure}
 		\item Persona relacionada: Este objeto esta relacionado con el paciente. A partir del navegador de la cabecera, en la parte de historias de vida se accede a la sección de personas relacionadas, una vez allí se nos muestra un listado con las personas relacionadas del paciente que tiene seleccionado el terapeuta (Figura \ref{fig:listpr}). Cada persona en el listado contiene el nombre, apellido, tipo de relación, correo electrónico y la posibilidad de ver, editar o borrar, según la opción elegida nos aparecerá un formulario con los campos bloqueados si has elegido la opción de ver o con la posibilidad de modificar los campos en caso de elegir la opción de editar (Figura \ref{fig:formpr}).
 		\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/listPersRel.png}
  	\caption{Listado personas relacionadas.}
  	
	\label{fig:listpr}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/formPR.png}
  	\caption{Formulario personas relacionadas.}
  	
	\label{fig:formpr}
\end{figure}
 		\item Recuerdo: Este objeto esta relacionado con el paciente y con las personas relacionadas. A partir del navegador de la cabecera, en la parte de historias de vida se accede a la sección de recuerdos, una vez allí se nos muestra un listado con los recuerdos  del paciente que tiene seleccionado el terapeuta (Figura \ref{fig:rec}). Cada recuerdo en el listado contiene el nombre, fecha, etapa de la vida , categoría, estado, etiqueta (positivo, neutro, negativo), categoría y unos botones con la posibilidad de ver, editar o borrar, según la opción elegida nos aparecerá un formulario con los campos bloqueados si has elegido la opción de ver o con la posibilidad de modificar los campos en caso de elegir la opción de editar (Figura \ref{fig:formRec}). Además de la información nombrada anteriormente una vez seleccionado el botón de ver o editar, también mostrará el formulario anteriormente comentado con esos campos y además con los campos de puntuación, descripción, emoción, categoría, localización; también un listado de personas relacionadas, con la posibilidad de añadir más; y la opción de añadir archivos multimedia relacionados con este recuerdo.
 			\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/listRecuerdos.png}
  	\caption{Listado recuerdos.}
  	
	\label{fig:rec}
\end{figure}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/formRecuerdos.png}
  	\caption{Formulario recuerdos.}
  	\label{fig:formRec}
\end{figure}
  	
 		
 		\item Actividad: Este objeto está directamente relacionado con el calendario, estas actividades son una especie de tareas que el terapeuta manda al cuidador del paciente y son registradas en el calendario. Con ayuda del plugin FullCalendar de JavaScript, hemos implementado un calendario donde se guardan estas actividades que están almacenadas en la base de datos.
 		Estas actividades se añaden a través del botón del "+" que sale en la cabecera del calendario o haciendo click en el día que quieres establecer esa actividad, una vez elegida una de estas opciones, aparecerá un formulario para rellenar con los datos de la actividad (Figura: \ref{fig:formCal}). 
 		\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/formCal.png}
  	\caption{Formulario nueva actividad.}
  	
	\label{fig:formCal}
	\end{figure}
		\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/calendario.png}
  	\caption{Calendario.}
	\label{fig:Cal}
	\end{figure}
	Para modificar o eliminar una actividad hay que hacer click sobre esta y nos aparecerá el formulario anteriormente vacío con todos los datos rellenos y con los botones de eliminar y modificar que son mandados a un documento PHP para tratar la información según la opción elegida (Figura \ref{fig:modCal}).
 	\end{itemize}
\begin{figure}[!ht]
  	\centering
  	\includegraphics[width=12cm]{./Imagenes/Figuras/implementacion/modCal.png}
  	\caption{Modificar/eliminar actividad.}
	\label{fig:modCal}
	\end{figure}


